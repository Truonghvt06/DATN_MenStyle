<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <title>MenStyle - Chi tiết người dùng</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" rel="stylesheet" />
  <style>
    * { box-sizing: border-box; }
    body {
      font-family: 'Segoe UI', sans-serif;
      margin: 0;
      padding: 0;
      background-color: #f5f5f5;
      display: flex;
      min-height: 100vh;
    }

    .sidebar {
      width: 240px;
      height: 100vh;
      background: #fff;
      padding: 30px 20px;
      box-shadow: 2px 0 6px rgba(0, 0, 0, 0.05);
      display: flex;
      flex-direction: column;
      gap: 16px;
      position: fixed;
      top: 0;
      left: 0;
      transition: all 0.3s ease;
      z-index: 1000;
    }

    .sidebar a {
      text-decoration: none;
      color: #333;
      font-weight: 500;
      padding: 10px 15px;
      border-radius: 6px;
      display: flex;
      align-items: center;
      gap: 10px;
      transition: 0.3s;
    }

    .sidebar a:hover {
      background: #111;
      color: #fff;
    }

    .content {
      margin-left: 240px;
      flex: 1;
      display: flex;
      flex-direction: column;
    }

    header {
      background-color: #111;
      color: #fff;
      padding: 15px 20px;
      font-size: 22px;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 15px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.2);
    }

    main {
      padding: 30px;
      flex: 1;
    }

    .card {
      background: #fff;
      border-radius: 12px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      padding: 20px;
      margin-bottom: 20px;
    }

    .card-title {
      font-size: 18px;
      font-weight: 600;
      margin-bottom: 15px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .info-item {
      margin-bottom: 10px;
      color: #555;
    }

    .info-item strong {
      color: #333;
    }

    .table th, .table td {
      vertical-align: middle;
      text-align: left;
      padding: 8px;
    }

    .table th { font-weight: 600; color: #333; }
    .table td { color: #555; }

    .avatar-img {
      max-width: 120px;
      border-radius: 8px;
    }
  </style>
</head>
<body>
  <!-- Sidebar -->
  <nav class="sidebar">
    <a href="/"><i class="bi bi-house"></i> Trang chủ</a>
    <a href="/products/view"><i class="bi bi-box"></i> Sản phẩm</a>
    <a href="/coupons/view"><i class="bi bi-ticket"></i> Phiếu giảm giá</a>
    <a href="/accounts/view"><i class="bi bi-people"></i> Tài khoản</a>
    <a href="/orders/view"><i class="bi bi-receipt-cutoff"></i> Đơn hàng</a>
    <a href="/stats/overview"><i class="bi bi-bar-chart-line"></i> Thống kê</a>
  </nav>

  <!-- Content -->
  <div class="content">
    <header>MenStyle - Chi tiết người dùng</header>
    <main>
      <!-- Thông tin người dùng -->
      <div class="card">
        <div class="card-title"><i class="bi bi-person-circle"></i> Thông tin người dùng</div>
        <div class="row">
          <div class="col-md-6">
            <div class="info-item"><strong>Tên:</strong> <%= user.name %></div>
            <div class="info-item"><strong>Email:</strong> <%= user.email %></div>
            <div class="info-item"><strong>SĐT:</strong> <%= user.phone %></div>
            <div class="info-item"><strong>Giới tính:</strong> <%= user.gender || 'Chưa cung cấp' %></div>
            <div class="info-item"><strong>Ngày sinh:</strong> <%= user.date_of_birth || 'Chưa cung cấp' %></div>
            <div class="info-item"><strong>Cập nhật:</strong> <%= new Date(user.updatedAt).toLocaleDateString('vi-VN') %></div>
          </div>
          <div class="col-md-6 text-center">
            <% if (user.avatar) { %>
              <img src="<%= user.avatar %>" alt="Avatar" class="avatar-img" />
            <% } else { %>
              <p class="text-muted">Không có ảnh đại diện</p>
            <% } %>
          </div>
        </div>
      </div>

      <!-- Giỏ hàng -->
      <div class="card mt-4">
        <div class="card-title"><i class="bi bi-cart-fill"></i> Giỏ hàng (<%= user.cart.length %> sản phẩm)</div>
        <% if (user.cart.length > 0) { %>
          <table class="table table-borderless">
            <thead>
              <tr>
                <th>Hình ảnh</th>
                <th>Sản phẩm</th>
                <th>Màu / Size</th>
                <th>Số lượng</th>
              </tr>
            </thead>
            <tbody>
              <% user.cart.forEach(item => {
                const variant = item.productId?.variants?.[item.variantIndex];
              %>
                <tr>
                  <td>
                    <% if (variant?.image) { %>
                      <img src="<%= variant.image %>" style="max-width: 50px;" />
                    <% } else { %>
                      Không có ảnh
                    <% } %>
                  </td>
                  <td><%= item.productId?.name || 'Không rõ tên' %></td>
                  <td><%= (variant?.color || 'Không rõ') + ' / ' + (variant?.size || 'Không rõ') %></td>
                  <td><%= item.quantity %></td>
                </tr>
              <% }) %>
              
            </tbody>
          </table>
        <% } else { %>
          <p class="text-muted">Giỏ hàng trống</p>
        <% } %>
      </div>

      <!-- Yêu thích -->
      <div class="card mt-4">
        <div class="card-title"><i class="bi bi-heart-fill"></i> Danh sách yêu thích (<%= user.favorites.length %> sản phẩm)</div>
        <% if (user.favorites.length > 0) { %>
          <ul>
            <% user.favorites.forEach(item => { %>
              <li><%= item.productId?.name || 'Không có tên' %></li>
            <% }) %>
          </ul>
        <% } else { %>
          <p class="text-muted">Danh sách yêu thích trống</p>
        <% } %>
      </div>
    </main>
  </div>
</body>
</html>
